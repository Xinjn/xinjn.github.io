"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[12350],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>k});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),i=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=i(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),m=i(t),k=r,u=m["".concat(s,".").concat(k)]||m[k]||d[k]||l;return t?a.createElement(u,o(o({ref:n},c),{},{components:t})):a.createElement(u,o({ref:n},c))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=m;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var i=2;i<l;i++)o[i]=t[i];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},45302:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>p,toc:()=>i});var a=t(87462),r=(t(67294),t(3905));const l={},o="Docker \u53d1\u5e03\u90e8\u7f72 DEMO",p={unversionedId:"\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO",id:"\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO",title:"Docker \u53d1\u5e03\u90e8\u7f72 DEMO",description:"\u524d\u7aef\u5bb9\u5668\u5316",source:"@site/docs/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO.md",sourceDirName:"\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf",slug:"/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO",permalink:"/docs/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72DEMO.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Docker \u53d1\u5e03\u90e8\u7f72",permalink:"/docs/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/Docker\u53d1\u5e03\u90e8\u7f72"},next:{title:"nginx \u53cd\u5411\u4ee3\u7406",permalink:"/docs/\u9879\u76ee\u7ecf\u9a8c/\u51e4\u51f0\u65b0\u95fb\u65f6\u95f4\u7ebf/nginx \u53cd\u5411\u4ee3\u7406"}},s={},i=[{value:"\u524d\u7aef\u5bb9\u5668\u5316",id:"\u524d\u7aef\u5bb9\u5668\u5316",level:2},{value:"Node \u5bb9\u5668\u5316",id:"node-\u5bb9\u5668\u5316",level:2},{value:"\u5173\u8054\u524d\u7aef\u4e0e Node \u5bb9\u5668\u5316",id:"\u5173\u8054\u524d\u7aef\u4e0e-node-\u5bb9\u5668\u5316",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}],c={toc:i};function d(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"docker-\u53d1\u5e03\u90e8\u7f72-demo"},"Docker \u53d1\u5e03\u90e8\u7f72 DEMO"),(0,r.kt)("h2",{id:"\u524d\u7aef\u5bb9\u5668\u5316"},"\u524d\u7aef\u5bb9\u5668\u5316"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u672c\u5730\u5f00\u53d1(3000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"npm run start\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u672c\u5730\u7f16\u8bd1 (8000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"npm run build\nhttp-server -p 8000 ./build\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u6dfb\u52a0.dockerignore")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"node_modules;\nbuild;\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"\u6dfb\u52a0 Dockerfile\uff0880\uff09")),(0,r.kt)("p",null,"\u901a\u8fc7 \u5176\u4ed6\u670d\u52a1\u955c\u50cf node/nginx \u7b49 \u521b\u5efa \u81ea\u5b9a\u4e49\u955c\u50cf"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'# \u57fa\u4e8enode14\nFROM node:14\n\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\nENV PROJECT_ENV production\nENV NODE_ENV production\n\n# \u5b89\u88c5nginx\nRUN apt-get update && apt-get install -y nginx\n\n# \u628a package.json package-lock.json \u590d\u5236\u5230/app\u76ee\u5f55\u4e0b\n# \u4e3a\u4e86npm install\u53ef\u4ee5\u7f13\u5b58\nCOPY package*.json /app/\n\n# \u5207\u6362\u5230app\u76ee\u5f55\nWORKDIR /app\n\n# \u5b89\u88c5\u4f9d\u8d56\nRUN npm install --registry=https://registry.npm.taobao.org\n\n# \u628a\u6240\u6709\u6e90\u4ee3\u7801\u62f7\u8d1d\u5230/app\nCOPY . /app\n\n# \u6253\u5305\u6784\u5efa\nRUN npm run build\n\n# \u62f7\u8d1d\u914d\u7f6e\u6587\u4ef6\u5230nginx\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\n\nEXPOSE 80\n\n# \u542f\u52a8nginx\uff0c\u5173\u95ed\u5b88\u62a4\u5f0f\u8fd0\u884c\uff0c\u5426\u5219\u5bb9\u5668\u542f\u52a8\u540e\u4f1a\u7acb\u523b\u5173\u95ed\nCMD ["nginx", "-g", "daemon off;"]\n\n')),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa\u955c\u50cf\uff08\u521b\u5efa 80 \u7aef\u53e3\uff09")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker build -t example/react-app .\n")),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"\u542f\u52a8\u5bb9\u5668(\u6620\u5c04 8888:80)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker run -d --name react-example  -p 8888:80 example/react-app\n")),(0,r.kt)("h2",{id:"node-\u5bb9\u5668\u5316"},"Node \u5bb9\u5668\u5316"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u672c\u5730\u5f00\u53d1(redis 6379)(node 3000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u542f\u52a8redis\nredis-server\n\nnode index.js\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa\u7f51\u7edc")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker network create app-example\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb\u901a\u4fe1(redis 6389:6379)\uff08node 3000\uff09")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker run -d --name redis-example --network app-example  -p 6389:6379 redis\n\ndocker run -it --name node-example --network app-example node:14 /bin/bash\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u6d4b\u8bd5\u901a\u4fe1")),(0,r.kt)("p",null,"\u81ea\u52a8\u8fdb\u5165 node-example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"ping redis-example\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"\u4fee\u6539 redis \u7684 host \u6539\u4e3a db\n\u7edf\u4e00 host")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const redis = new Redis({\n  port: 6379,\n  host: "db",\n});\n')),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u65b0\u5efa\u4e00\u4e2a Dockerfile(\u8bbe\u7f6e\u7aef\u53e3\u4e3a 3000 \u540c node \u5f00\u53d1\u7aef\u53e3\u4e00\u81f4)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'# \u57fa\u4e8enode14\nFROM node:14\n\n# \u628a package.json package-lock.json \u590d\u5236\u5230/app\u76ee\u5f55\u4e0b\n# \u4e3a\u4e86npm install\u53ef\u4ee5\u7f13\u5b58\nCOPY package*.json /app/\n\n# \u5207\u6362\u5230app\u76ee\u5f55 \u540ccd\nWORKDIR /app\n\n# \u5b89\u88c5\u4f9d\u8d56\nRUN npm install\n\n# \u628a\u6240\u6709\u6e90\u4ee3\u7801\u62f7\u8d1d\u5230/app\nCOPY . /app\n\n# \u8bbe\u7f6e\u7aef\u53e3\nEXPOSE 3000\n\n# \u8fd0\u884cnode index.js\nCMD ["node","index.js"]\n\n')),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"\u6784\u5efa\u955c\u50cf(\u6784\u5efa\u7aef\u53e3\u4e3a 3000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker build -t example/node-redis-app .\n")),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"\u542f\u52a8\u5bb9\u5668(redis 6389:6379)(node 4444:3000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"# \u521b\u5efa\u7f51\u7edc\ndocker network create app-example\n\n# \u7aef\u53e3\u51b2\u7a81\uff1a\u9700\u8981\u5148\u5220\u9664 redis-example \u5bb9\u5668\n\n# \u91cd\u65b0\u542f\u52a8redis\u5bb9\u5668\ndocker run -d --name db --network app-example  -p 6389:6379 redis\n\n# \u5173\u95ed\u65e0\u7528node-example \u6d4b\u8bd5\u5bb9\u5668\n\n# \u542f\u52a8node-redid \u5bb9\u5668\ndocker run --name node-redis-example -p 4444:3000 --network app-example -d example/node-redis-app\n")),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"\u6d4b\u8bd5 http://localhost:4444/")),(0,r.kt)("h2",{id:"\u5173\u8054\u524d\u7aef\u4e0e-node-\u5bb9\u5668\u5316"},"\u5173\u8054\u524d\u7aef\u4e0e Node \u5bb9\u5668\u5316"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u4fee\u6539 react-app \u76ee\u5f55\u4e0b\u7684 nginx.conf(\u6620\u5c04 3000)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"server {\n    listen       80;\n    server_name  localhost;\n\n    location / {\n        root   /app/build; # \u6253\u5305\u7684\u8def\u5f84\n        index  index.html index.htm;\n        try_files $uri $uri/ /index.html; # \u9632\u6b62\u91cd\u5237\u65b0\u8fd4\u56de404\n    }\n\n    location /api {\n        proxy_pass http://node-redis-example:3000; # \u6dfb\u52a0\u540e\u53f0api \u4ee3\u7406\u5730\u5740\n    }\n\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n}\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u91cd\u65b0\u6784\u5efa\u955c\u50cf")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker build -t example/react-node .\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u542f\u52a8\u5bb9\u5668\uff089999:80\uff09")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"docker run -d --name react-node-example --network app-example  -p 9999:80 example/react-node\n")),(0,r.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,r.kt)("p",null,"\u524d\u7aef \u5bb9\u5668\u5316\ntimeline/react-nginx-node\uff1a\u521b\u5efa react-nginx \u5173\u8054 node \u5bb9\u5668\uff0c\u524d\u7aef\u9879\u76ee react \u53ef\u4ee5\u901a\u8fc7 nginx \u64cd\u4f5c node \u5c42\uff0c\u8fdb\u4e00\u6b65\u64cd\u4f5c mysql \u6570\u636e\u5e93"),(0,r.kt)("p",null,"Node \u5bb9\u5668\u5316\nmysql:5.7\uff08\u672a\u7528\u5230\uff0c\u542f\u52a8\u9519\u8bef\uff09\uff1a\u521b\u5efa mysql \u5bb9\u5668\uff0c\u542f\u52a8 mysql \u6570\u636e\u5e93\ntimeline/node-mysql\uff1a\u521b\u5efa node \u5173\u8054 mysql \u5bb9\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7 node \u64cd\u4f5c mysql \u6570\u636e\u5e93"))}d.isMDXComponent=!0}}]);
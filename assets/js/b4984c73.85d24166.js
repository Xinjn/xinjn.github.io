"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[33794],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var o=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=o.createContext({}),s=function(e){var n=o.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=s(e.components);return o.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(t),m=a,f=d["".concat(c,".").concat(m)]||d[m]||u[m]||r;return t?o.createElement(f,l(l({ref:n},p),{},{components:t})):o.createElement(f,l({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,l=new Array(r);l[0]=d;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var s=2;s<r;s++)l[s]=t[s];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},5602:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var o=t(87462),a=(t(67294),t(3905));const r={},l=void 0,i={unversionedId:"\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236",id:"\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236",title:"\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236",description:"\u80cc\u666f",source:"@site/docs/\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236.md",sourceDirName:"\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView",slug:"/\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236",permalink:"/docs/\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/\u6dfb\u52a0\u8fb9\u7f18\u9650\u5236.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"[MovableView](https://docs.taro.zone/docs/components/viewContainer/movable-view)",permalink:"/docs/\u6846\u67b6/\u524d\u53f0/Taro/\u7ec4\u4ef6\u5e93/\u89c6\u56fe\u5bb9\u5668/MovableView/"},next:{title:"[UploadTask](https://taro-docs.jd.com/taro/docs/apis/network/upload/UploadTask)",permalink:"/docs/\u6846\u67b6/\u524d\u53f0/Taro/\u7f51\u7edc/\u4e0a\u4f20/UploadTask"}},c={},s=[{value:"\u80cc\u666f",id:"\u80cc\u666f",level:2},{value:"\u539f\u56e0",id:"\u539f\u56e0",level:2},{value:"\u89e3\u51b3\u65b9\u6cd5",id:"\u89e3\u51b3\u65b9\u6cd5",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}],p={toc:s};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u80cc\u666f"},"\u80cc\u666f"),(0,a.kt)("p",null,"\u5f00\u53d1\u4e2d\uff0c\u62d6\u62fd\u529f\u80fd\u5b9e\u73b0\u5c31\u662f\u4e09\u4e2a\u65b9\u6cd5 touchstart,touchmove,touchend,\u4e5f\u5f88\u5bb9\u6613\uff0c\u4f46\u662f\u5728\u6df7\u5408\u5f00\u53d1\u4e2d\uff0cios \u91cc\u9762\uff0c\u5f53 H5 \u9875\u9762\u91cc\u9762\u7684\u62d6\u52a8\u8fdb\u884c\u7684\u65f6\u5019\uff0c\u624b\u6307\u5212\u51fa\u5c4f\u5e55\u65f6\uff0c\u4e0d\u4f1a\u89e6\u53d1 touchen \u4e8b\u4ef6\uff0c\u540c\u65f6\uff0ctouchmove \u4e8b\u4ef6\u5c31\u4f1a\u4e00\u76f4\u5b58\u5728\uff0c\u90a3\u4e48\u8fd9\u5c31\u51fa\u73b0\u4e86 bug\uff0c\u6240\u6709\u7684\u62d6\u62fd\u4e8b\u4ef6\u5426\u4e0d\u80fd\u5728\u6267\u884c\u4e86\uff0c\u56e0\u4e3a\u4e0a\u4e00\u4e2a\u7684 touchemove \u6ca1\u6709\u7ed3\u675f\uff01\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462"),(0,a.kt)("h2",{id:"\u539f\u56e0"},"\u539f\u56e0"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"MovableView")," \u5feb\u901f\u6ed1\u52a8\u65f6\u6709\u65f6\u5019\u65e0\u6cd5\u76d1\u542c ",(0,a.kt)("inlineCode",{parentName:"p"},"touchEnd")," \u4e8b\u4ef6"),(0,a.kt)("h2",{id:"\u89e3\u51b3\u65b9\u6cd5"},"\u89e3\u51b3\u65b9\u6cd5"),(0,a.kt)("p",null,"\u5728 touchMove \u91cc\u9762\u8fdb\u884c\u5224\u65ad\uff0c\u5230\u8fbe\u67d0\u4e00\u4e2a\u4e34\u754c\u70b9\u7684\u65f6\u5019\u5c06\u4e8b\u4ef6\u6253\u65ad\u5373\u53ef(\u6216\u8005\u4f7f\u7528 alert\uff08\uff09\u81ea\u5e26\u7684\u6253\u65ad\u529f\u80fd)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import React, { useEffect, useState } from "react";\nimport Taro, { Component } from "@tarojs/taro";\nimport {\n  View,\n  MovableArea,\n  MovableView,\n  Image,\n  Text,\n} from "@tarojs/components";\nimport styles from "./index.module.less";\n\nexport default function opusFeed3(props) {\n  const { listId } = props;\n  // \u8bb0\u5f55\u4e0a\u6b21\u4f4d\u7f6e\u4fe1\u606f\n  const [last, setLast] = useState({ lastX: 0, lastY: 0 });\n  const [state, setState] = useState([\n    {\n      top: 0,\n      left: 0,\n      content: "\u5185\u5bb91",\n    },\n    {\n      top: 100,\n      left: 0,\n      content: "\u5185\u5bb9222",\n    },\n    {\n      top: 200,\n      left: 0,\n      content: "\u5185\u5bb9333",\n    },\n  ]);\n\n  // \u8bb0\u5f55\u4e0a\u6b21\u7684\u4f4d\u7f6e\n  const onTouchStart = (e) => {\n    e.preventDefault();\n    const { pageY, pageX } = e.changedTouches[0];\n    setLast({ lastX: pageX, lastY: pageY });\n  };\n  // \u6dfb\u52a0\u9650\u5236\uff1a\u7531\u4e8e\u5feb\u901f\u9519\u62fd\u51fa\u5c4f\u5e55touchend\u540e\u4e0d\u89e6\u53d1\uff0c\u9700\u8981\u5f3a\u5236\u6253\u65ad\n  const onTouchMove = (e) => {\n    const { pageX, pageY } = e.changedTouches[0];\n    const { lastX, lastY } = last;\n\n    console.log("pageY - lastY", pageY - lastY);\n    // \u5c4f\u5e55\u5bbd\u5ea6\n    const clientWidth = 400;\n    // \u533a\u57df\u9ad8\u5ea6\n    const MovableAreaHeight = 300;\n    if (pageX - lastX > clientWidth || pageX - lastX < 0) {\n      e.preventDefault();\n      console.log("\u8d85\u51faX\u9650\u5236");\n      onTouchEnd();\n      return;\n    }\n    if (pageY - lastY > MovableAreaHeight || pageY - lastY < 0) {\n      e.preventDefault();\n      console.log("\u8d85\u51faY\u9650\u5236");\n      onTouchEnd();\n      return;\n    }\n  };\n\n  const onTouchCancel = () => {\n    console.log("onTouchCancel");\n    clearTimeout(timer);\n    let timer = setTimeout(() => {\n      setState([\n        {\n          top: 0,\n          left: 0,\n          content: "\u5185\u5bb91",\n        },\n        {\n          top: 100,\n          left: 0,\n          content: "\u5185\u5bb9222",\n        },\n        {\n          top: 200,\n          left: 0,\n          content: "\u5185\u5bb9333",\n        },\n      ]);\n      // \u6e05\u96f6\n      setLast({ lastX: 0, lastY: 0 });\n    }, 100);\n  };\n\n  const onTouchEnd = () => {\n    console.log("onTouchEnd");\n    clearTimeout(timer);\n    let timer = setTimeout(() => {\n      setState([\n        {\n          top: 0,\n          left: 0,\n          content: "\u5185\u5bb91",\n        },\n        {\n          top: 100,\n          left: 0,\n          content: "\u5185\u5bb9222",\n        },\n        {\n          top: 200,\n          left: 0,\n          content: "\u5185\u5bb9333",\n        },\n      ]);\n      // \u6e05\u96f6\n      setLast({ lastX: 0, lastY: 0 });\n    }, 100);\n  };\n\n  const handleChange = (e, i) => {\n    const test = state.slice();\n    test[i] = {\n      top: e.detail.y,\n      left: e.detail.x,\n      content: test[i].content,\n    };\n    setState(test);\n  };\n\n  return (\n    <View className={styles.pageBody}>\n      <MovableArea style="height:300px;width:100%">\n        {state.map((el, i) => {\n          return (\n            <MovableView\n              style="width:100%;height:100px;border:1px solid red;"\n              key={i}\n              direction="all"\n              x={el.left}\n              y={el.top}\n              onTouchStart={onTouchStart}\n              onTouchMove={onTouchMove}\n              onTouchEnd={onTouchEnd}\n              onTouchCancel={onTouchCancel}\n              onChange={(e) => handleChange(e, i)}\n              animation={false}\n            >\n              <View> {el.content}</View>\n            </MovableView>\n          );\n        })}\n      </MovableArea>\n    </View>\n  );\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-css"},".pageBody {\n  background: #ffffff\n    url(https://x0.ifengimg.com/ucms/2021_47/027B7788BC18A519F99A1372340EA4DBFB3A7149_size52_w750_h466.png)\n    no-repeat 0 -88px;\n  background-size: 100% auto;\n  font-family: PingFangSC-Regular, PingFang SC;\n  display: flex;\n  flex-direction: column;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n")),(0,a.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/NervJS/taro/issues/1981"},"\u5c0f\u7a0b\u5e8f MovableView \u8bbe\u7f6e\u5750\u6807\u540e\u65e0\u6cd5\u91cd\u65b0\u6e32\u67d3")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://blog.csdn.net/weixin_33712987/article/details/94464452"},"\u6df7\u5408\u5f00\u53d1\u4e2d\uff0c\u62d6\u62fd\u529f\u80fd\uff0c\u624b\u6307\u5212\u51fa\u5c4f\u5e55\u4e0d\u80fd\u89e6\u53d1 touchend \u4e8b\u4ef6")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://blog.csdn.net/daipianpian/article/details/107511366"},"\u79fb\u52a8\u7aef bug\uff0c\u90e8\u5206\u5b89\u5353\u673a\u578b\u4e0b touchend \u4e8b\u4ef6\u76d1\u542c\u4e0d\u5230")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://segmentfault.com/q/1010000002943205"},"\u5728 ios8 \u7684 webview \u4e2d\uff0c\u5f53\u624b\u6307\u6ed1\u52a8\u5143\u7d20\u5230 webview \u8fb9\u754c\u5916\u4ee5\u540e\u677e\u5f00\uff0c\u4e0d\u80fd\u89e6\u53d1 touchend \u4e8b\u4ef6\uff0c\u4ec0\u4e48\u539f\u56e0\uff1f\u600e\u4e48\u89e3\u51b3\uff1f")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://jartto.wang/2015/06/25/solutions-to-touchend-on-mobile/"},"\u79fb\u52a8\u7aef touchend \u4e8b\u4ef6\u4e0d\u89e6\u53d1\u89e3\u51b3\u65b9\u6848")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.aliyun.com/article/139431"},"Dom \u53d8\u66f4\u5f15\u8d77\u7684 touchend \u4e0d\u89e6\u53d1")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.yangrunwei.com/a/14.html"},"\u79fb\u52a8\u7aef touchend \u4e0d\u89e6\u53d1 Bug"))))}u.isMDXComponent=!0}}]);